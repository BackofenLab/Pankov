language: cpp
compiler:
- gcc
- clang
before_install:
- sudo add-apt-repository -y ppa:ubuntu-toolchain-r/test
- sudo add-apt-repository -y ppa:h-rayflood/llvm-upper
- sudo apt-add-repository -y ppa:j-4/vienna-rna
- sudo apt-get update -q -y
install:
- sudo apt-get install -qq viennarna viennarna-dev
- sudo apt-get install -qq help2man
- sudo apt-get install -qq libgsl0-dev
- if [ "$CXX" == "clang++" ]; then sudo apt-get install --allow-unauthenticated -y
  clang-3.6; fi
- if [ "$CXX" == "clang++" ]; then export CXX="clang++-3.6"; fi
before_script:
- autoreconf -i
script: ./configure && make -j4 && make -j4 check && make dist-gzip

before_deploy:
  - export DIST_GZIP=$(ls locarna-*.tar.gz)
  - echo "Deploying autoconf's ${DIST_GZIP} to GitHub releases"

deploy:
  provider: releases
  api_key:
    secure: rHvVz0u8eLMD/m95NscWxqrvQJcwzoWqDU2FVg0toURBjzsPCYa/7t4s1Pu26ycCXW9fOc2UEJhQ60AVHuMFIM9n7EFJEqygZPZXs+Is6lFlQXphN8frWa2xb7gi25LvxH/mnd+XWIZdCTUT7us1rk9msXn48y7S9sR4qSIq8ibwB/5ZwtGCR9fybfdx4mhkIloUTGKjSslsFpwTjVLx/Ch1F3yULANMvaS8gwS7pE0d4Ci6HPFO7vi7QRtGJmtmeSvm+pNpriZ7oe/YUA+EWMWDRKyJQI2diM0j+V2YLcNB60Z2BO0L5My8Gre++pIwSgjd+uTy/p7Nwy8w8BT6LKSlwHwAM/lPd8JAzGoN+yBKEHUwJcnIfeGbG5RVgSNFn+8SOsECvy15JncMb+1rFLp3GrTCJhV+JSU6zvFLMZ9LzlKB8ARKZd9DrSW39zDWO6HRO53HMM6M5hjWV+msGYexQjmqRSc/U8nxYwtNziVJy2ndbp40eZnMMF9J8vMy/sWQy1U44amcIj+J+N8jc9rfIRx3/R559udCgYx+Tpn6GJVXd71ruLAWChVDWGE06kHHKgG8aljpZMUbwjG50Af3XyGLuuOBSMV2q7YDgQLkY9veSfhj6Znf9gQijRypLy6GJYAwVet8+MttYdN/sAjIqBZl9plLhJg3MXJtSfw=
  skip_cleanup: true
  file_glob: true
  file: "${DIST_GZIP}"
  on:
    repo: s-will/LocARNA
    tags: true
